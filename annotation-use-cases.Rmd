---
title: "Supplementary data for: \\textit{A flexible, modular, expandable ecosystem for metabolimics data annotation in R}"
author: "Johannes Rainer, Andrea Vicini, Sebastian Gibb, Laurent Gatto, and Michael Witting"
graphics: yes
output:
  BiocStyle::pdf_document
---

```{r  biocstyle, echo = FALSE, results = "asis", message = FALSE }
library(BiocStyle)
BiocStyle::markdown()
```

This documents provides XXX use cases describing the annotation of non-target
metabolomics and small compound datasets using functionality from the
`r Biocpkg("MetaboAnnotation")` and `r Biocpkg("MetaboCoreUtils")` packages
which is well integrated with the `r Biocpkg("xcms")`, `r Biocpkg("Spectra")`,
`r Biocpkg("MsBackendMassbank")` and `r Biocpkg("CompoundDb")` packages. All
data used in this document is available within the [github
repository](https://github.com/jorainer/annotation_ecosystem) or through the
`r Biocpkg("msdata")` package.

# MS1 annotation

In this example we annotate chromatographic peaks identified in a test sample
first based only on their m/z values and then using their m/z and retention
time. The data set is provided by the `r Biocpkg("msdata")` package and consists
of a DDA experiment on a pesticide mix sample (@Michael, please expand).

Below we load the data and perform the chromatographic peak detection using the
`r Biocpkg("xcms")` package.

```{r}
library(xcms)
library(msdata)
pest_file <- system.file("TripleTOF-SWATH", "PestMix1_DDA.mzML",
                         package = "msdata")
pest_data <- readMSData(pest_file, mode = "onDisk")

```

We next perform the chromatographic peak detection using the *centWave*
algorithm (see the *LC-MS/MS data analysis with xcms* vignette from the `xcms`
package for details on the chromatographic peak detection settings).

```{r}
cwp <- CentWaveParam(snthresh = 5, noise = 100, ppm = 10,
                     peakwidth = c(3, 30))
pest_all <- findChromPeaks(pest_all, param = cwp)
```

In total `r nrow(chromPeaks(pest_all))` chromatographic peaks have been
identified. Below we display the first 6 of them.

```{r}
head(chromPeaks(pest_all))
```

MassBank CompDb.

- Pestizide DDA data set?
- Add retention time and adduct information to a `CompDb`/`IonDb`.

# MS2 annotation

-